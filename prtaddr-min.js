document.write('<div class="code-list"><pre><div><span class="line-numbers">  1 <\/span><span class="line-data"><span class="ch">#!/usr/bin/env python3<\/span><\/span><\/div><div><span class="line-numbers">  2 <\/span><span class="line-data"><span class="c1"># prtaddr - Print Address to HAGAKI<\/span><\/span><\/div><div><span class="line-numbers">  3 <\/span><span class="line-data"><span class="c1">#<\/span><\/span><\/div><div><span class="line-numbers">  4 <\/span><span class="line-data"><span class="c1"># manontanto<\/span><\/span><\/div><div><span class="line-numbers">  5 <\/span><span class="line-data"><span class="c1">#<\/span><\/span><\/div><div><span class="line-numbers">  6 <\/span><span class="line-data"><span class="kn">from<\/span> <span class="nn">tkinter<\/span> <span class="kn">import<\/span> <span class="n">filedialog<\/span> <span class="k">as<\/span> <span class="n">tkdialog<\/span><\/span><\/div><div><span class="line-numbers">  7 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">os<\/span><\/span><\/div><div><span class="line-numbers">  8 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">sys<\/span><\/span><\/div><div><span class="line-numbers">  9 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">glob<\/span><\/span><\/div><div><span class="line-numbers"> 10 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">subprocess<\/span><\/span><\/div><div><span class="line-numbers"> 11 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">csv<\/span><\/span><\/div><div><span class="line-numbers"> 12 <\/span><span class="line-data"><span class="kn">from<\/span> <span class="nn">reportlab.pdfgen<\/span> <span class="kn">import<\/span> <span class="n">canvas<\/span><\/span><\/div><div><span class="line-numbers"> 13 <\/span><span class="line-data"><span class="kn">from<\/span> <span class="nn">reportlab.pdfbase<\/span> <span class="kn">import<\/span> <span class="n">pdfmetrics<\/span><\/span><\/div><div><span class="line-numbers"> 14 <\/span><span class="line-data"><span class="kn">from<\/span> <span class="nn">reportlab.pdfbase.ttfonts<\/span> <span class="kn">import<\/span> <span class="n">TTFont<\/span><\/span><\/div><div><span class="line-numbers"> 15 <\/span><span class="line-data"><span class="kn">from<\/span> <span class="nn">reportlab.lib.units<\/span> <span class="kn">import<\/span> <span class="n">mm<\/span><\/span><\/div><div><span class="line-numbers"> 16 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">vobject<\/span><\/span><\/div><div><span class="line-numbers"> 17 <\/span><span class="line-data"><span class="kn">import<\/span> <span class="nn">PyPDF2<\/span><\/span><\/div><div><span class="line-numbers"> 18 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers"> 19 <\/span><span class="line-data"><span class="n">root<\/span> <span class="o">=<\/span> <span class="n">tkdialog<\/span><span class="o">.<\/span><span class="n">Tk<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers"> 20 <\/span><span class="line-data"><span class="n">root<\/span><span class="o">.<\/span><span class="n">withdraw<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers"> 21 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers"> 22 <\/span><span class="line-data"><span class="n">GEN_SHIN_GOTHIC<\/span> <span class="o">=<\/span> <span class="n">PATH_TO_FONTS<\/span> <span class="o">+<\/span> <span class="s1">&#39;GenShinGothic-P-Light.ttf&#39;<\/span><\/span><\/div><div><span class="line-numbers"> 23 <\/span><span class="line-data"><span class="n">WORK_DIR<\/span> <span class="o">=<\/span>  <span class="n">PATH_TO_WORK<\/span><\/span><\/div><div><span class="line-numbers"> 24 <\/span><span class="line-data"><span class="k">try<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 25 <\/span><span class="line-data">    <span class="n">os<\/span><span class="o">.<\/span><span class="n">mkdir<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span><span class="p">)<\/span>  <span class="c1"># python3<\/span><\/span><\/div><div><span class="line-numbers"> 26 <\/span><span class="line-data"><span class="k">except<\/span> <span class="ne">FileExistsError<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 27 <\/span><span class="line-data">    <span class="k">pass<\/span><\/span><\/div><div><span class="line-numbers"> 28 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers"> 29 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">mk1PDF<\/span><span class="p">(<\/span><span class="n">pg<\/span><span class="p">,<\/span> <span class="n">l<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers"> 30 <\/span><span class="line-data">    <span class="p">(<\/span><span class="n">sei<\/span><span class="p">,<\/span> <span class="n">mei<\/span><span class="p">,<\/span> <span class="n">post_code<\/span><span class="p">,<\/span> <span class="n">addr<\/span><span class="p">,<\/span> <span class="n">renmei<\/span><span class="p">)<\/span> <span class="o">=<\/span> <span class="n">l<\/span><\/span><\/div><div><span class="line-numbers"> 31 <\/span><span class="line-data">    <span class="n">c<\/span> <span class="o">=<\/span> <span class="n">canvas<\/span><span class="o">.<\/span><span class="n">Canvas<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span> <span class="o">+<\/span> <span class="s1">&#39;card&#39;<\/span> <span class="o">+<\/span> <span class="nb">str<\/span><span class="p">(<\/span><span class="n">pg<\/span><span class="p">)<\/span> <span class="o">+<\/span> <span class="s1">&#39;.pdf&#39;<\/span><span class="p">,<\/span>\\<\/span><\/div><div><span class="line-numbers"> 32 <\/span><span class="line-data">            <span class="n">pagesize<\/span><span class="o">=<\/span><span class="p">(<\/span><span class="mi">100<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="mi">148<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">))<\/span><\/span><\/div><div><span class="line-numbers"> 33 <\/span><span class="line-data">    <span class="n">pdfmetrics<\/span><span class="o">.<\/span><span class="n">registerFont<\/span><span class="p">(<\/span><span class="n">TTFont<\/span><span class="p">(<\/span><span class="s1">&#39;GenShinGothic&#39;<\/span><span class="p">,<\/span> <span class="n">GEN_SHIN_GOTHIC<\/span><span class="p">))<\/span><\/span><\/div><div><span class="line-numbers"> 34 <\/span><span class="line-data">    <span class="c1"># Create textobject<\/span><\/span><\/div><div><span class="line-numbers"> 35 <\/span><span class="line-data">    <span class="n">textobject<\/span> <span class="o">=<\/span> <span class="n">c<\/span><span class="o">.<\/span><span class="n">beginText<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers"> 36 <\/span><span class="line-data"><span class="c1">#   郵便番号<\/span><\/span><\/div><div><span class="line-numbers"> 37 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setTextOrigin<\/span><span class="p">(<\/span><span class="mi">45<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="mi">126<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 38 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setFont<\/span><span class="p">(<\/span><span class="s1">&#39;GenShinGothic&#39;<\/span><span class="p">,<\/span> <span class="mi">20<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 39 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setCharSpace<\/span><span class="p">(<\/span><span class="mf">8.4<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 40 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="s1">&#39;-&#39;<\/span> <span class="ow">in<\/span> <span class="n">post_code<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 41 <\/span><span class="line-data">        <span class="n">post_code<\/span> <span class="o">=<\/span> <span class="n">post_code<\/span><span class="p">[<\/span><span class="mi">0<\/span><span class="p">:<\/span><span class="mi">3<\/span><span class="p">]<\/span> <span class="o">+<\/span> <span class="n">post_code<\/span><span class="p">[<\/span><span class="mi">4<\/span><span class="p">:<\/span><span class="mi">8<\/span><span class="p">]<\/span><\/span><\/div><div><span class="line-numbers"> 42 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">post_code<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 43 <\/span><span class="line-data"><span class="c1">#   住所<\/span><\/span><\/div><div><span class="line-numbers"> 44 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setTextOrigin<\/span><span class="p">(<\/span><span class="mi">30<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="mi">90<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 45 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setFont<\/span><span class="p">(<\/span><span class="s1">&#39;GenShinGothic&#39;<\/span><span class="p">,<\/span> <span class="mi">11<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 46 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setCharSpace<\/span><span class="p">(<\/span><span class="mi">0<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 47 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="s1">&#39; &#39;<\/span> <span class="ow">in<\/span> <span class="n">addr<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 48 <\/span><span class="line-data">        <span class="n">addr_lines<\/span> <span class="o">=<\/span> <span class="n">addr<\/span><span class="o">.<\/span><span class="n">split<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers"> 49 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">addr_lines<\/span><span class="p">[<\/span><span class="mi">0<\/span><span class="p">])<\/span><\/span><\/div><div><span class="line-numbers"> 50 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">addr_lines<\/span><span class="p">[<\/span><span class="mi">1<\/span><span class="p">])<\/span><\/span><\/div><div><span class="line-numbers"> 51 <\/span><span class="line-data">    <span class="k">else<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 52 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">addr<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 53 <\/span><span class="line-data"><span class="c1">#   氏名<\/span><\/span><\/div><div><span class="line-numbers"> 54 <\/span><span class="line-data"><span class="c1">#    textobject.setTextOrigin(30 * mm, 80 * mm)<\/span><\/span><\/div><div><span class="line-numbers"> 55 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">moveCursor<\/span><span class="p">(<\/span><span class="mi">0<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="mi">5<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 56 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setCharSpace<\/span><span class="p">(<\/span><span class="mi">4<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 57 <\/span><span class="line-data">    <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">sei<\/span> <span class="o">+<\/span> <span class="s1">&#39; &#39;<\/span> <span class="o">+<\/span> <span class="n">mei<\/span> <span class="o">+<\/span> <span class="s1">&#39; 様&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 58 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="n">renmei<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 59 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="n">sei<\/span> <span class="o">+<\/span> <span class="s1">&#39; &#39;<\/span> <span class="o">+<\/span> <span class="n">renmei<\/span> <span class="o">+<\/span> <span class="s1">&#39; 様&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 60 <\/span><span class="line-data"><span class="c1">#   料金別納    <\/span><\/span><\/div><div><span class="line-numbers"> 61 <\/span><span class="line-data">    <span class="k">def<\/span> <span class="nf">stamp<\/span><span class="p">():<\/span><\/span><\/div><div><span class="line-numbers"> 62 <\/span><span class="line-data">        <span class="n">x<\/span> <span class="o">=<\/span> <span class="mf">12.2<\/span><\/span><\/div><div><span class="line-numbers"> 63 <\/span><span class="line-data">        <span class="n">y<\/span> <span class="o">=<\/span> <span class="mf">113.8<\/span><\/span><\/div><div><span class="line-numbers"> 64 <\/span><span class="line-data">        <span class="n">w<\/span> <span class="o">=<\/span> <span class="mi">18<\/span><\/span><\/div><div><span class="line-numbers"> 65 <\/span><span class="line-data">        <span class="n">h<\/span> <span class="o">=<\/span> <span class="mf">20.8<\/span><\/span><\/div><div><span class="line-numbers"> 66 <\/span><span class="line-data">        <span class="n">c<\/span><span class="o">.<\/span><span class="n">setLineWidth<\/span><span class="p">(<\/span><span class="mf">0.1<\/span><span class="o">*<\/span><span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 67 <\/span><span class="line-data">        <span class="n">c<\/span><span class="o">.<\/span><span class="n">rect<\/span><span class="p">(<\/span><span class="n">x<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="n">y<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="n">w<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="n">h<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 68 <\/span><span class="line-data">        <span class="n">c<\/span><span class="o">.<\/span><span class="n">line<\/span><span class="p">(<\/span><span class="n">x<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">y<\/span> <span class="o">+<\/span> <span class="mi">14<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">x<\/span> <span class="o">+<\/span> <span class="n">w<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">y<\/span> <span class="o">+<\/span> <span class="mi">14<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 69 <\/span><span class="line-data">        <span class="n">c<\/span><span class="o">.<\/span><span class="n">line<\/span><span class="p">(<\/span><span class="n">x<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">y<\/span> <span class="o">+<\/span> <span class="mi">9<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">x<\/span> <span class="o">+<\/span> <span class="n">w<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">y<\/span> <span class="o">+<\/span> <span class="mi">9<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 70 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setTextOrigin<\/span><span class="p">((<\/span><span class="n">x<\/span> <span class="o">+<\/span> <span class="mf">0.8<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">,<\/span> <span class="p">(<\/span><span class="n">y<\/span> <span class="o">+<\/span> <span class="mf">10.5<\/span><span class="p">)<\/span> <span class="o">*<\/span> <span class="n">mm<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 71 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setFont<\/span><span class="p">(<\/span><span class="s1">&#39;GenShinGothic&#39;<\/span><span class="p">,<\/span> <span class="mi">8<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 72 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">setCharSpace<\/span><span class="p">(<\/span><span class="mi">0<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 73 <\/span><span class="line-data">        <span class="n">textobject<\/span><span class="o">.<\/span><span class="n">textLine<\/span><span class="p">(<\/span><span class="s1">&#39;料金別納郵便&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 74 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers"> 75 <\/span><span class="line-data"><span class="c1">#    stamp()<\/span><\/span><\/div><div><span class="line-numbers"> 76 <\/span><span class="line-data"><span class="c1">#   テキスト<\/span><\/span><\/div><div><span class="line-numbers"> 77 <\/span><span class="line-data">    <span class="n">c<\/span><span class="o">.<\/span><span class="n">drawText<\/span><span class="p">(<\/span><span class="n">textobject<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers"> 78 <\/span><span class="line-data">    <span class="n">c<\/span><span class="o">.<\/span><span class="n">save<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers"> 79 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers"> 80 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">readvcf<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers"> 81 <\/span><span class="line-data">    <span class="sd">&quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers"> 82 <\/span><span class="line-data"><span class="sd">    vcardファイルを読み，姓・名・郵便番号・住所・連名をリストにする<\/span><\/span><\/div><div><span class="line-numbers"> 83 <\/span><span class="line-data"><span class="sd">    vcardファイルは，Big Sur/連絡先.appの仕様による<\/span><\/span><\/div><div><span class="line-numbers"> 84 <\/span><span class="line-data"><span class="sd">    &quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers"> 85 <\/span><span class="line-data">    <span class="n">addr_list<\/span> <span class="o">=<\/span> <span class="p">[]<\/span><\/span><\/div><div><span class="line-numbers"> 86 <\/span><span class="line-data">    <span class="k">with<\/span> <span class="nb">open<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">,<\/span> <span class="s1">&#39;r&#39;<\/span><span class="p">)<\/span> <span class="k">as<\/span> <span class="n">vcf_file<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers"> 87 <\/span><span class="line-data">        <span class="k">for<\/span> <span class="n">vcard<\/span> <span class="ow">in<\/span> <span class="n">vobject<\/span><span class="o">.<\/span><span class="n">readComponents<\/span><span class="p">(<\/span><span class="n">vcf_file<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers"> 88 <\/span><span class="line-data">            <span class="n">sei<\/span> <span class="o">=<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">n<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">family<\/span><\/span><\/div><div><span class="line-numbers"> 89 <\/span><span class="line-data">            <span class="n">mei<\/span> <span class="o">=<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">n<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">given<\/span><\/span><\/div><div><span class="line-numbers"> 90 <\/span><span class="line-data">            <span class="n">pcode<\/span> <span class="o">=<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">code<\/span><\/span><\/div><div><span class="line-numbers"> 91 <\/span><span class="line-data">            <span class="n">addr<\/span> <span class="o">=<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">region<\/span> <span class="o">+<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">city<\/span> \\<\/span><\/div><div><span class="line-numbers"> 92 <\/span><span class="line-data">                        <span class="o">+<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">street<\/span> <span class="o">+<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">extended<\/span> \\<\/span><\/div><div><span class="line-numbers"> 93 <\/span><span class="line-data">                        <span class="o">+<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">adr<\/span><span class="o">.<\/span><span class="n">value<\/span><span class="o">.<\/span><span class="n">box<\/span><\/span><\/div><div><span class="line-numbers"> 94 <\/span><span class="line-data">            <span class="n">renmei<\/span> <span class="o">=<\/span> <span class="s1">&#39;&#39;<\/span><\/span><\/div><div><span class="line-numbers"> 95 <\/span><span class="line-data">            <span class="k">if<\/span> <span class="nb">hasattr<\/span><span class="p">(<\/span><span class="n">vcard<\/span><span class="p">,<\/span> <span class="s1">&#39;x_abrelatednames&#39;<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers"> 96 <\/span><span class="line-data">                <span class="n">renmei<\/span> <span class="o">=<\/span> <span class="n">vcard<\/span><span class="o">.<\/span><span class="n">x_abrelatednames<\/span><span class="o">.<\/span><span class="n">value<\/span><\/span><\/div><div><span class="line-numbers"> 97 <\/span><span class="line-data">            <span class="n">addr_list<\/span><span class="o">.<\/span><span class="n">append<\/span><span class="p">([<\/span><span class="n">sei<\/span><span class="p">,<\/span> <span class="n">mei<\/span><span class="p">,<\/span> <span class="n">pcode<\/span><span class="p">,<\/span> <span class="n">addr<\/span><span class="p">,<\/span> <span class="n">renmei<\/span><span class="p">])<\/span><\/span><\/div><div><span class="line-numbers"> 98 <\/span><span class="line-data">        <span class="k">return<\/span> <span class="n">addr_list<\/span><\/span><\/div><div><span class="line-numbers"> 99 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">100 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">readcsv<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers">101 <\/span><span class="line-data">    <span class="sd">&quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers">102 <\/span><span class="line-data"><span class="sd">    csvファイルを読み，姓・名・郵便番号・住所・連名をリストにする<\/span><\/span><\/div><div><span class="line-numbers">103 <\/span><span class="line-data"><span class="sd">    読み取るファイルは，この順序の5カラムのみが許容される<\/span><\/span><\/div><div><span class="line-numbers">104 <\/span><span class="line-data"><span class="sd">    &quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers">105 <\/span><span class="line-data">    <span class="k">with<\/span> <span class="nb">open<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">,<\/span> <span class="s1">&#39;r&#39;<\/span><span class="p">)<\/span> <span class="k">as<\/span> <span class="n">csv_file<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">106 <\/span><span class="line-data">        <span class="n">csv_reader<\/span> <span class="o">=<\/span> <span class="n">csv<\/span><span class="o">.<\/span><span class="n">reader<\/span><span class="p">(<\/span><span class="n">csv_file<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">107 <\/span><span class="line-data">        <span class="n">l<\/span> <span class="o">=<\/span> <span class="nb">list<\/span><span class="p">(<\/span><span class="n">csv_reader<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">108 <\/span><span class="line-data">        <span class="k">if<\/span> <span class="nb">len<\/span><span class="p">(<\/span><span class="n">l<\/span><span class="p">[<\/span><span class="mi">0<\/span><span class="p">])<\/span> <span class="o">!=<\/span> <span class="mi">5<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">109 <\/span><span class="line-data">            <span class="nb">print<\/span><span class="p">(<\/span><span class="n">l<\/span><span class="p">[<\/span><span class="mi">0<\/span><span class="p">])<\/span><\/span><\/div><div><span class="line-numbers">110 <\/span><span class="line-data">            <span class="nb">print<\/span><span class="p">(<\/span><span class="s1">&#39;This CSV file must have 5 culumns.&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">111 <\/span><span class="line-data">            <span class="nb">print<\/span><span class="p">(<\/span><span class="s1">&#39;姓, 名, 郵便番号, 住所, 連名&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">112 <\/span><span class="line-data">            <span class="nb">print<\/span><span class="p">(<\/span><span class="s1">&#39;Please check the file contents.&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">113 <\/span><span class="line-data">            <span class="n">sys<\/span><span class="o">.<\/span><span class="n">exit<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">114 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">115 <\/span><span class="line-data">        <span class="k">return<\/span> <span class="n">l<\/span><\/span><\/div><div><span class="line-numbers">116 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">117 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">combine<\/span><span class="p">():<\/span><\/span><\/div><div><span class="line-numbers">118 <\/span><span class="line-data">    <span class="sd">&quot;&quot;&quot; PDFをまとめて1ファイルにしてWORK_DIRに置く&quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers">119 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">120 <\/span><span class="line-data">    <span class="n">pdf_writer<\/span> <span class="o">=<\/span> <span class="n">PyPDF2<\/span><span class="o">.<\/span><span class="n">PdfFileWriter<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">121 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">122 <\/span><span class="line-data">    <span class="n">pdf_files<\/span> <span class="o">=<\/span> <span class="p">[]<\/span><\/span><\/div><div><span class="line-numbers">123 <\/span><span class="line-data">    <span class="n">pdf_files<\/span> <span class="o">=<\/span> <span class="n">glob<\/span><span class="o">.<\/span><span class="n">glob<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span> <span class="o">+<\/span> <span class="s1">&#39;card*.pdf&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">124 <\/span><span class="line-data">    <span class="k">for<\/span> <span class="n">filename<\/span> <span class="ow">in<\/span> <span class="n">pdf_files<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">125 <\/span><span class="line-data">        <span class="n">pdf_file_obj<\/span> <span class="o">=<\/span> <span class="nb">open<\/span><span class="p">(<\/span><span class="n">filename<\/span><span class="p">,<\/span> <span class="s1">&#39;rb&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">126 <\/span><span class="line-data">        <span class="n">pdf_reader<\/span> <span class="o">=<\/span> <span class="n">PyPDF2<\/span><span class="o">.<\/span><span class="n">PdfFileReader<\/span><span class="p">(<\/span><span class="n">pdf_file_obj<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">127 <\/span><span class="line-data">        <span class="n">page_obj<\/span> <span class="o">=<\/span> <span class="n">pdf_reader<\/span><span class="o">.<\/span><span class="n">getPage<\/span><span class="p">(<\/span><span class="mi">0<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">128 <\/span><span class="line-data">        <span class="n">pdf_writer<\/span><span class="o">.<\/span><span class="n">addPage<\/span><span class="p">(<\/span><span class="n">page_obj<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">129 <\/span><span class="line-data">    <span class="n">pdf_output<\/span> <span class="o">=<\/span> <span class="nb">open<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span> <span class="o">+<\/span> <span class="s1">&#39;combined.pdf&#39;<\/span><span class="p">,<\/span> <span class="s1">&#39;wb&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">130 <\/span><span class="line-data">    <span class="n">pdf_writer<\/span><span class="o">.<\/span><span class="n">write<\/span><span class="p">(<\/span><span class="n">pdf_output<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">131 <\/span><span class="line-data">    <span class="n">pdf_output<\/span><span class="o">.<\/span><span class="n">close<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">132 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">133 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">readfn<\/span><span class="p">():<\/span><\/span><\/div><div><span class="line-numbers">134 <\/span><span class="line-data">    <span class="sd">&quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers">135 <\/span><span class="line-data"><span class="sd">    入力ファイル名を得る<\/span><\/span><\/div><div><span class="line-numbers">136 <\/span><span class="line-data"><span class="sd">    ファイル名には&#39;.csv&#39;, &#39;.vcf&#39;の拡張子が不可欠<\/span><\/span><\/div><div><span class="line-numbers">137 <\/span><span class="line-data"><span class="sd">    &quot;&quot;&quot;<\/span><\/span><\/div><div><span class="line-numbers">138 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">139 <\/span><span class="line-data">    <span class="n">read_fileName<\/span> <span class="o">=<\/span> <span class="n">tkdialog<\/span><span class="o">.<\/span><span class="n">askopenfilename<\/span><span class="p">(<\/span><span class="n">initialdir<\/span><span class="o">=<\/span><span class="n">os<\/span><span class="o">.<\/span><span class="n">chdir<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span><span class="p">))<\/span><\/span><\/div><div><span class="line-numbers">140 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="ow">not<\/span> <span class="n">read_fileName<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">141 <\/span><span class="line-data">        <span class="n">sys<\/span><span class="o">.<\/span><span class="n">exit<\/span><span class="p">()<\/span> <span class="c1"># null read_fileName<\/span><\/span><\/div><div><span class="line-numbers">142 <\/span><span class="line-data">    <span class="k">return<\/span> <span class="n">read_fileName<\/span><\/span><\/div><div><span class="line-numbers">143 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">144 <\/span><span class="line-data"><span class="k">def<\/span> <span class="nf">main<\/span><span class="p">():<\/span><\/span><\/div><div><span class="line-numbers">145 <\/span><span class="line-data">    <span class="n">fileName<\/span> <span class="o">=<\/span> <span class="n">readfn<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">146 <\/span><span class="line-data"><span class="c1">#    *.vcf or *.csv ?????<\/span><\/span><\/div><div><span class="line-numbers">147 <\/span><span class="line-data">    <span class="n">addrList<\/span> <span class="o">=<\/span> <span class="p">[]<\/span><\/span><\/div><div><span class="line-numbers">148 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="n">os<\/span><span class="o">.<\/span><span class="n">path<\/span><span class="o">.<\/span><span class="n">splitext<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">)[<\/span><span class="mi">1<\/span><span class="p">]<\/span> <span class="o">==<\/span> <span class="s1">&#39;.vcf&#39;<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">149 <\/span><span class="line-data">        <span class="n">addrList<\/span> <span class="o">=<\/span> <span class="n">readvcf<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">150 <\/span><span class="line-data">    <span class="k">elif<\/span> <span class="n">os<\/span><span class="o">.<\/span><span class="n">path<\/span><span class="o">.<\/span><span class="n">splitext<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">)[<\/span><span class="mi">1<\/span><span class="p">]<\/span> <span class="o">==<\/span> <span class="s1">&#39;.csv&#39;<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">151 <\/span><span class="line-data">        <span class="n">addrList<\/span> <span class="o">=<\/span> <span class="n">readcsv<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">152 <\/span><span class="line-data">    <span class="k">else<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">153 <\/span><span class="line-data">        <span class="nb">print<\/span><span class="p">(<\/span><span class="n">fileName<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">154 <\/span><span class="line-data">        <span class="nb">print<\/span><span class="p">(<\/span><span class="s1">&#39;Only *.vcf or *.csv&#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">155 <\/span><span class="line-data">        <span class="n">sys<\/span><span class="o">.<\/span><span class="n">exit<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">156 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">157 <\/span><span class="line-data">    <span class="n">count_pg<\/span> <span class="o">=<\/span> <span class="mi">1<\/span><\/span><\/div><div><span class="line-numbers">158 <\/span><span class="line-data">    <span class="k">for<\/span> <span class="n">l<\/span> <span class="ow">in<\/span> <span class="n">addrList<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">159 <\/span><span class="line-data">        <span class="n">mk1PDF<\/span><span class="p">(<\/span><span class="n">count_pg<\/span><span class="p">,<\/span><span class="n">l<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">160 <\/span><span class="line-data">        <span class="n">count_pg<\/span> <span class="o">+=<\/span> <span class="mi">1<\/span><\/span><\/div><div><span class="line-numbers">161 <\/span><span class="line-data">    <span class="n">combine<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">162 <\/span><span class="line-data">    <span class="k">for<\/span> <span class="n">f<\/span> <span class="ow">in<\/span> <span class="n">glob<\/span><span class="o">.<\/span><span class="n">glob<\/span><span class="p">(<\/span><span class="n">WORK_DIR<\/span> <span class="o">+<\/span> <span class="s1">&#39;card*.pdf&#39;<\/span><span class="p">):<\/span><\/span><\/div><div><span class="line-numbers">163 <\/span><span class="line-data">        <span class="n">os<\/span><span class="o">.<\/span><span class="n">remove<\/span><span class="p">(<\/span><span class="n">f<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">164 <\/span><span class="line-data">    <span class="n">k<\/span> <span class="o">=<\/span> <span class="nb">input<\/span><span class="p">(<\/span><span class="s1">&#39;Printer 準備 OK? [Y/n]: &#39;<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">165 <\/span><span class="line-data">    <span class="k">if<\/span> <span class="n">k<\/span><span class="o">.<\/span><span class="n">lower<\/span><span class="p">()<\/span>  <span class="ow">not<\/span> <span class="ow">in<\/span> <span class="p">[<\/span><span class="s1">&#39;y&#39;<\/span><span class="p">,<\/span> <span class="s1">&#39;yes&#39;<\/span><span class="p">]:<\/span><\/span><\/div><div><span class="line-numbers">166 <\/span><span class="line-data">        <span class="n">sys<\/span><span class="o">.<\/span><span class="n">exit<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">167 <\/span><span class="line-data">    <span class="n">subprocess<\/span><span class="o">.<\/span><span class="n">run<\/span><span class="p">([<\/span><span class="s1">&#39;lpr&#39;<\/span><span class="p">,<\/span> <span class="s1">&#39;-P&#39;<\/span><span class="p">,<\/span> <span class="s1">&#39;EPSON_EP_707A_Series&#39;<\/span><span class="p">,<\/span> <span class="n">WORK_DIR<\/span> <span class="o">+<\/span> <span class="s1">&#39;combined.pdf&#39;<\/span><span class="p">],<\/span>\\<\/span><\/div><div><span class="line-numbers">168 <\/span><span class="line-data">            <span class="n">check<\/span><span class="o">=<\/span><span class="kc">True<\/span><span class="p">)<\/span><\/span><\/div><div><span class="line-numbers">169 <\/span><span class="line-data"><\/span><\/div><div><span class="line-numbers">170 <\/span><span class="line-data"><span class="k">if<\/span> <span class="vm">__name__<\/span> <span class="o">==<\/span> <span class="s1">&#39;__main__&#39;<\/span><span class="p">:<\/span><\/span><\/div><div><span class="line-numbers">171 <\/span><span class="line-data">    <span class="n">main<\/span><span class="p">()<\/span><\/span><\/div><div><span class="line-numbers">172 <\/span><span class="line-data"><\/span><\/div><\/pre><\/div>')
